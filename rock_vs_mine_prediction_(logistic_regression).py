# -*- coding: utf-8 -*-
"""Rock vs Mine Prediction (logistic regression).ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1KLy6VnoeFodiaXfQ9JUCam5z0kUHiSVQ
"""

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

#loading the dataset to pandas dataframe
neo_data = pd.read_csv("/content/neo.csv")
# sonar_data = pd.read_csv("/content/sonar_data.csv")

neo_data.head()

#number of rows and column
neo_data.shape

neo_data.describe()

# neo_data[9].value_counts()

# neo_data.groupby[9]

x = neo_data.drop(['id','name','orbiting_body','sentry_object','hazardous'], axis=1)
y = neo_data[['hazardous']]

print(x)
print(y)

#splitting the data in training and testing data

# x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.1, stratify=y, random_state=1)
x_train = x[:45000]
x_test = x[45000:50170]
y_train = y[:45000]
y_test = y[45000:50170]
print(x_train)
print(y_test)

print(x.shape, x_train.shape, x_test.shape)

print(y.shape, y_train.shape, y_test.shape)

model = LogisticRegression()

#training the model

model.fit(x_train, y_train)

#evaluating model
#accuracy on training data
x_train_prediction = model.predict(x_train)
train_data_acc = accuracy_score(x_train_prediction, y_train)

print(train_data_acc)

#accuracy on testing data
x_test_prediction = model.predict(x_test)
test_data_acc = accuracy_score(x_test_prediction, y_test)
print(test_data_acc)

#making a predictive system
input_data = (0.0868070458,0.1941064553,45322.7950229882,40953447.44734707,22.43)

#changing the input data to numpy array
input_numpy_array = np.asarray(input_data)

#reshape the array as we are predicting for one instance
input_data_reshaped = input_numpy_array.reshape(1, -1)

prediction = model.predict(input_data_reshaped)
print(prediction)

if prediction[0] == "R":
  print("The Object is a rock")

elif prediction[0] == "M":
  print("Caution!! Mine ahead")

else:
  print(" I don't know what it is")

"""**Voila!!**"""